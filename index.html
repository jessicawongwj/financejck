<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Finance Pro</title>
    
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="FinancePro">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;700;800&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --blue-deep: #1727AE;
            --blue-main: #2C43B8;
            --blue-mid: #445BC1;
            --blue-light: #97BAEC;
            --bg-soft: #FBFBFE;
        }

        body { 
            font-family: 'Plus Jakarta Sans', sans-serif; 
            background-color: var(--bg-soft);
            color: #1A1C1E;
            -webkit-tap-highlight-color: transparent;
        }

        .glass-card {
            background: white;
            border-radius: 28px;
            border: 1px solid #F0F0F7;
            box-shadow: 0 10px 30px -10px rgba(44, 67, 184, 0.08);
        }

        .btn-blue { background: var(--blue-main); color: white; }
        .btn-blue:active { transform: scale(0.96); opacity: 0.9; }

        .tab-active { background: var(--blue-main) !important; color: white !important; }
        
        .cat-btn { transition: all 0.2s; border: 2px solid transparent; }
        .cat-selected { border-color: var(--blue-main); background: #EEF2FF; }

        .no-scrollbar::-webkit-scrollbar { display: none; }
        .mono { font-variant-numeric: tabular-nums; letter-spacing: -0.5px; }
        
        /* Smooth transitions for charts */
        #chartCanvas { max-height: 200px; }
    </style>
</head>
<body class="pb-10">

    <div class="max-w-md mx-auto px-5 py-8">
        <header class="flex justify-between items-center mb-8">
            <div>
                <h1 class="text-2xl font-extrabold tracking-tight" style="color: var(--blue-deep);">Finance Pro</h1>
                <p id="dateDisplay" class="text-[10px] font-bold text-slate-400 uppercase tracking-widest"></p>
            </div>
            <div class="flex gap-2">
                <button onclick="exportData()" class="w-10 h-10 flex items-center justify-center rounded-full bg-white border border-slate-100 shadow-sm">
                    <svg class="w-5 h-5 text-slate-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"/></svg>
                </button>
            </div>
        </header>

        <div class="glass-card p-6 mb-8 bg-white overflow-hidden relative border-none" style="background: linear-gradient(135deg, var(--blue-deep) 0%, var(--blue-main) 100%);">
            <div class="relative z-10 text-white">
                <div class="flex justify-between items-center mb-1">
                    <p class="text-xs font-medium text-blue-100 opacity-70">Monthly Net Balance</p>
                    <select id="monthSelector" onchange="updateStats()" class="bg-white/10 text-[10px] font-bold rounded-lg px-2 py-1 outline-none border-none"></select>
                </div>
                <h2 id="netIncome" class="text-4xl font-black mb-6 mono">$ 0.00</h2>
                <div class="grid grid-cols-2 gap-4 border-t border-white/10 pt-4">
                    <div>
                        <p class="text-[9px] text-blue-200 uppercase font-black tracking-wider">Income</p>
                        <p id="totalIncome" class="text-lg font-bold mono">$ 0.00</p>
                    </div>
                    <div>
                        <p class="text-[9px] text-blue-200 uppercase font-black tracking-wider">Expenses</p>
                        <p id="totalExpense" class="text-lg font-bold mono">$ 0.00</p>
                    </div>
                </div>
            </div>
            <div class="absolute -right-10 -top-10 w-40 h-40 bg-white/5 rounded-full"></div>
        </div>

        <section class="mb-8">
            <h3 class="text-xs font-black text-slate-400 uppercase tracking-widest mb-4 px-1 flex justify-between">
                <span>Ongoing & Utilities</span>
                <span id="avgOngoingLabel" class="text-[var(--blue-main)]">Avg: $0/mo</span>
            </h3>
            <div class="grid grid-cols-2 gap-4">
                <div class="glass-card p-4">
                    <p class="text-[9px] font-black text-slate-400 uppercase mb-3">App Subs</p>
                    <div id="subList" class="space-y-2 mb-3"></div>
                    <button onclick="addSubscription()" class="w-full py-2 text-[9px] font-black text-blue-600 bg-blue-50 rounded-xl hover:bg-blue-100 uppercase tracking-tighter">+ Monthly</button>
                </div>
                <div class="glass-card p-4">
                    <p class="text-[9px] font-black text-slate-400 uppercase mb-3">Quarterly Bills</p>
                    <div id="qList" class="space-y-2 mb-3"></div>
                    <button onclick="addQuarterly()" class="w-full py-2 text-[9px] font-black text-orange-600 bg-orange-50 rounded-xl hover:bg-orange-100 uppercase tracking-tighter">+ Quarterly</button>
                </div>
            </div>
        </section>

        <div class="glass-card p-6 mb-8">
            <div class="flex gap-2 mb-6 p-1 bg-slate-100 rounded-2xl">
                <button id="expTab" onclick="switchType('expense')" class="tab-active flex-1 py-2.5 rounded-xl text-xs font-bold transition-all">Expense</button>
                <button id="incTab" onclick="switchType('income')" class="flex-1 py-2.5 rounded-xl text-xs font-bold text-slate-400 transition-all">Income</button>
            </div>

            <div class="space-y-5">
                <div class="flex gap-2 overflow-x-auto no-scrollbar pb-2">
                    <button onclick="quickAdd(5.5, 'Fun', 'Coffee ‚òï')" class="whitespace-nowrap px-3 py-1.5 rounded-lg bg-slate-50 text-slate-600 text-[10px] font-bold border border-slate-100">‚òï $5.5 Coffee</button>
                    <button onclick="quickAdd(18, 'Variable', 'Lunch üç±')" class="whitespace-nowrap px-3 py-1.5 rounded-lg bg-slate-50 text-slate-600 text-[10px] font-bold border border-slate-100">üç± $18 Lunch</button>
                    <button onclick="quickAdd(80, 'Variable', 'Grocery üõí')" class="whitespace-nowrap px-3 py-1.5 rounded-lg bg-slate-50 text-slate-600 text-[10px] font-bold border border-slate-100">üõí $80 Grocery</button>
                </div>

                <div class="relative pt-2">
                    <span class="absolute left-0 top-0 text-[10px] font-black text-blue-400 uppercase tracking-widest">Amount (AUD)</span>
                    <input id="amount" type="number" step="0.01" placeholder="0.00" class="w-full pt-6 pb-2 text-4xl font-black outline-none border-b-2 border-slate-50 focus:border-blue-500 transition-all mono">
                </div>

                <div id="catGrid" class="grid grid-cols-3 gap-2"></div>

                <input id="note" type="text" placeholder="Note / Description" class="w-full p-4 bg-slate-50 rounded-2xl text-sm outline-none focus:ring-2 ring-blue-50 transition-all">
                
                <button onclick="saveRecord()" class="btn-blue w-full py-4 rounded-2xl font-extrabold text-sm uppercase tracking-widest shadow-xl shadow-blue-200">Save Transaction</button>
            </div>
        </div>

        <div class="glass-card p-6">
            <div class="flex justify-between items-center mb-6">
                <h3 class="font-bold text-slate-800 tracking-tight">Timeline</h3>
                <button onclick="clearAll()" class="text-[10px] text-slate-300 font-bold uppercase tracking-widest">Clear All</button>
            </div>
            <div id="history" class="space-y-5"></div>
        </div>
    </div>

    <script>
        const CATEGORIES = {
            expense: [
                { name: 'Fixed', icon: 'üè†' }, { name: 'Variable', icon: 'üõí' },
                { name: 'Fun', icon: '‚òï' }, { name: 'Transit', icon: 'üöó' },
                { name: 'Health', icon: 'üíä' }, { name: 'Other', icon: 'üì¶' }
            ],
            income: [
                { name: 'Salary', icon: 'üíº' }, { name: 'Side', icon: 'üìà' },
                { name: 'Gift', icon: 'üéâ' }, { name: 'Other', icon: 'üí∞' }
            ]
        };

        let currentType = 'expense';
        let selectedCat = '';

        function init() {
            document.getElementById('dateDisplay').innerText = new Date().toLocaleDateString('en-AU', { weekday: 'long', day: 'numeric', month: 'long' });
            generateMonths();
            renderCats();
            updateStats();
            renderHistory();
            renderOngoing();
        }

        function generateMonths() {
            const sel = document.getElementById('monthSelector');
            const now = new Date();
            for (let i = 0; i < 12; i++) {
                const d = new Date(now.getFullYear(), now.getMonth() - i, 1);
                const v = `${d.getFullYear()}-${String(d.getMonth() + 1).padStart(2, '0')}`;
                sel.innerHTML += `<option value="${v}">${d.toLocaleDateString('en-AU', {month:'short', year:'numeric'})}</option>`;
            }
        }

        function switchType(t) {
            currentType = t;
            document.getElementById('expTab').className = t === 'expense' ? 'tab-active flex-1 py-2.5 rounded-xl text-xs font-bold' : 'flex-1 py-2.5 rounded-xl text-xs font-bold text-slate-400';
            document.getElementById('incTab').className = t === 'income' ? 'tab-active flex-1 py-2.5 rounded-xl text-xs font-bold' : 'flex-1 py-2.5 rounded-xl text-xs font-bold text-slate-400';
            selectedCat = '';
            renderCats();
        }

        function renderCats() {
            const container = document.getElementById('catGrid');
            container.innerHTML = CATEGORIES[currentType].map(c => `
                <button onclick="selectCat('${c.name}')" data-cat="${c.name}" class="cat-btn flex flex-col items-center p-3 rounded-2xl bg-slate-50 border-2 border-transparent">
                    <span class="text-xl mb-1">${c.icon}</span>
                    <span class="text-[9px] font-bold text-slate-500 uppercase">${c.name}</span>
                </button>
            `).join('');
        }

        function selectCat(n) {
            selectedCat = n;
            document.querySelectorAll('.cat-btn').forEach(b => b.classList.toggle('cat-selected', b.dataset.cat === n));
        }

        function saveRecord() {
            const amt = parseFloat(document.getElementById('amount').value);
            const note = document.getElementById('note').value || 'General';
            if (!amt || !selectedCat) return alert('Enter amount & category');

            const records = JSON.parse(localStorage.getItem('f_pro_data') || '[]');
            records.unshift({
                id: Date.now(),
                type: currentType,
                amount: amt,
                category: selectedCat,
                note: note,
                date: new Date().toISOString().split('T')[0]
            });
            localStorage.setItem('f_pro_data', JSON.stringify(records));
            
            document.getElementById('amount').value = '';
            document.getElementById('note').value = '';
            updateStats();
            renderHistory();
        }

        function quickAdd(amt, cat, note) {
            document.getElementById('amount').value = amt;
            document.getElementById('note').value = note;
            selectCat(cat);
            setTimeout(saveRecord, 300);
        }

        function updateStats() {
            const selM = document.getElementById('monthSelector').value;
            const records = JSON.parse(localStorage.getItem('f_pro_data') || '[]');
            const monthRecs = records.filter(r => r.date.startsWith(selM));

            const exp = monthRecs.filter(r => r.type === 'expense').reduce((s, r) => s + r.amount, 0);
            const inc = monthRecs.filter(r => r.type === 'income').reduce((s, r) => s + r.amount, 0);

            document.getElementById('totalExpense').innerText = `$ ${exp.toFixed(2)}`;
            document.getElementById('totalIncome').innerText = `$ ${inc.toFixed(2)}`;
            document.getElementById('netIncome').innerText = `$ ${(inc - exp).toFixed(2)}`;

            // Ongoing Avg Calculation
            const subs = JSON.parse(localStorage.getItem('f_pro_subs') || '[]');
            const qs = JSON.parse(localStorage.getItem('f_pro_qs') || '[]');
            const avg = subs.reduce((s,r)=>s+r.amt, 0) + qs.reduce((s,r)=>s+(r.amt/3), 0);
            document.getElementById('avgOngoingLabel').innerText = `Avg: $${avg.toFixed(0)}/mo`;
        }

        function renderHistory() {
            const records = JSON.parse(localStorage.getItem('f_pro_data') || '[]');
            document.getElementById('history').innerHTML = records.slice(0, 10).map(r => `
                <div class="flex items-center justify-between">
                    <div class="flex items-center gap-4">
                        <div class="w-11 h-11 flex items-center justify-center bg-slate-50 rounded-2xl text-lg">${CATEGORIES[r.type].find(c=>c.name===r.category)?.icon || 'üí∞'}</div>
                        <div>
                            <p class="text-xs font-bold text-slate-800">${r.category}</p>
                            <p class="text-[10px] text-slate-400 font-medium">${r.note}</p>
                        </div>
                    </div>
                    <div class="text-right">
                        <p class="text-sm font-black mono ${r.type==='expense'?'text-slate-800':'text-blue-600'}">${r.type==='expense'?'-':'+'} $${r.amount.toFixed(2)}</p>
                    </div>
                </div>
            `).join('') || '<p class="text-center text-xs text-slate-300">No records yet</p>';
        }

        // Ongoing Logic
        function addSubscription() {
            const n = prompt("App Name (e.g. Netflix):");
            const a = parseFloat(prompt("Monthly Cost ($):"));
            if (n && a) {
                const s = JSON.parse(localStorage.getItem('f_pro_subs') || '[]');
                s.push({id: Date.now(), name: n, amt: a});
                localStorage.setItem('f_pro_subs', JSON.stringify(s));
                renderOngoing(); updateStats();
            }
        }

        function addQuarterly() {
            const n = prompt("Bill Name (e.g. Water):");
            const a = parseFloat(prompt("Quarterly Cost ($):"));
            if (n && a) {
                const s = JSON.parse(localStorage.getItem('f_pro_qs') || '[]');
                s.push({id: Date.now(), name: n, amt: a});
                localStorage.setItem('f_pro_qs', JSON.stringify(s));
                renderOngoing(); updateStats();
            }
        }

        function renderOngoing() {
            const subs = JSON.parse(localStorage.getItem('f_pro_subs') || '[]');
            const qs = JSON.parse(localStorage.getItem('f_pro_qs') || '[]');
            document.getElementById('subList').innerHTML = subs.slice(-3).map(s => `<div class="flex justify-between text-[10px] font-bold text-slate-600"><span>${s.name}</span><span>$${s.amt}</span></div>`).join('');
            document.getElementById('qList').innerHTML = qs.slice(-3).map(q => `<div class="flex justify-between text-[10px] font-bold text-orange-600"><span>${q.name}</span><span>$${q.amt}</span></div>`).join('');
        }

        function clearAll() { if(confirm("Clear all transactions?")) { localStorage.removeItem('f_pro_data'); location.reload(); } }
        
        function exportData() {
            const records = JSON.parse(localStorage.getItem('f_pro_data') || '[]');
            let csv = 'Type,Category,Amount,Date,Note\n' + records.map(r => `${r.type},${r.category},${r.amount},${r.date},${r.note}`).join('\n');
            const blob = new Blob([csv], { type: 'text/csv' });
            const a = document.createElement('a'); a.href = URL.createObjectURL(blob); a.download = 'finance_export.csv'; a.click();
        }

        init();
    </script>
</body>
</html>
