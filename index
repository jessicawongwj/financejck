<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Finance Tracker - Blue Edition</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --blue-1: #1727AE;
            --blue-2: #2C43B8;
            --blue-3: #445BC1;
            --blue-4: #6987D5;
            --blue-5: #97BAEC;
            --blue-6: #BBDFFA;
        }

        * { font-family: 'Poppins', sans-serif; }

        body { 
            background-color: var(--blue-1);
            background-image: 
                radial-gradient(circle at 10% 20%, rgba(44, 67, 184, 0.4) 0%, transparent 40%),
                radial-gradient(circle at 90% 80%, rgba(105, 135, 213, 0.3) 0%, transparent 40%);
            background-attachment: fixed;
            min-height: 100vh;
            color: white;
        }

        /* ç»ç’ƒæ‹Ÿæ€å¡ç‰‡ */
        .glass-card {
            background: rgba(255, 255, 255, 0.08);
            backdrop-filter: blur(16px);
            -webkit-backdrop-filter: blur(16px);
            border: 1px solid rgba(255, 255, 255, 0.15);
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.3);
        }

        /* ç»Ÿä¸€è¾“å…¥æ¡†é£æ ¼ */
        .input-field {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: var(--blue-6);
            transition: all 0.3s ease;
        }
        .input-field:focus {
            background: rgba(255, 255, 255, 0.1);
            border-color: var(--blue-5);
            outline: none;
            box-shadow: 0 0 15px rgba(151, 186, 236, 0.2);
        }

        /* æŒ‰é’®é£æ ¼ */
        .primary-btn {
            background: linear-gradient(135deg, var(--blue-3) 0%, var(--blue-2) 100%);
            color: white;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .primary-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(23, 39, 174, 0.4);
            filter: brightness(1.1);
        }

        .tab-active {
            background: white !important;
            color: var(--blue-1) !important;
            font-weight: 800;
        }

        .category-btn {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
        }
        .category-selected {
            background: var(--blue-5) !important;
            color: var(--blue-1) !important;
            border-color: var(--blue-6);
            transform: scale(1.05);
        }

        /* éšè—æ•°å­—è¾“å…¥æ¡†ç®­å¤´ */
        input::-webkit-outer-spin-button,
        input::-webkit-inner-spin-button { -webkit-appearance: none; margin: 0; }

        .mono { font-family: 'Poppins', monospace; font-variant-numeric: tabular-nums; }
        
        .custom-scroll::-webkit-scrollbar { width: 6px; }
        .custom-scroll::-webkit-scrollbar-track { background: transparent; }
        .custom-scroll::-webkit-scrollbar-thumb { background: var(--blue-4); border-radius: 10px; }
    </style>
</head>
<body class="p-4 md:p-8">
    <div class="max-w-4xl mx-auto">
        <header class="flex justify-between items-end mb-10 px-2">
            <div>
                <h1 class="text-4xl font-extrabold tracking-tight text-white">Finance <span class="text-[var(--blue-5)]">Tracker</span></h1>
                <p class="text-[var(--blue-6)] opacity-70 text-sm font-medium">Monitoring your AUD finances in style</p>
            </div>
            <button onclick="exportData()" class="px-5 py-2.5 glass-card rounded-2xl text-xs font-bold uppercase tracking-widest hover:bg-white hover:text-[var(--blue-1)] transition-all">
                Export CSV
            </button>
        </header>

        <div class="grid lg:grid-cols-12 gap-8">
            <div class="lg:col-span-5 space-y-6">
                <div class="glass-card rounded-[2.5rem] p-8">
                    <div class="flex p-1.5 bg-black/20 rounded-2xl mb-8">
                        <button id="expenseTab" onclick="switchType('expense')" class="tab-active flex-1 py-3 rounded-xl text-sm font-bold transition-all">Expenses</button>
                        <button id="incomeTab" onclick="switchType('income')" class="flex-1 py-3 rounded-xl text-sm font-bold transition-all text-white/50">Income</button>
                    </div>

                    <div class="space-y-6">
                        <div>
                            <label class="text-[10px] font-bold text-[var(--blue-5)] uppercase tracking-[0.2em] mb-2 block">Transaction Amount</label>
                            <div class="relative">
                                <span class="absolute left-0 top-1/2 -translate-y-1/2 text-3xl font-bold text-[var(--blue-6)]">$</span>
                                <input id="amount" type="number" step="0.01" placeholder="0.00" 
                                    class="w-full pl-8 bg-transparent text-5xl font-extrabold outline-none text-white placeholder-white/10 mono">
                            </div>
                        </div>

                        <div>
                            <label class="text-[10px] font-bold text-[var(--blue-5)] uppercase tracking-[0.2em] mb-2 block">Category</label>
                            <div id="categoryContainer" class="grid grid-cols-3 gap-2"></div>
                        </div>

                        <div>
                            <label class="text-[10px] font-bold text-[var(--blue-5)] uppercase tracking-[0.2em] mb-2 block">Details</label>
                            <input id="note" type="text" placeholder="e.g. Weekly Groceries" class="input-field w-full p-4 rounded-2xl text-sm">
                        </div>

                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="text-[10px] font-bold text-[var(--blue-5)] uppercase tracking-[0.2em] mb-2 block">Date</label>
                                <input id="date" type="date" class="input-field w-full p-4 rounded-2xl text-xs font-bold">
                            </div>
                            <div class="flex items-end">
                                <button onclick="saveRecord()" class="primary-btn w-full h-[54px] rounded-2xl font-bold text-sm uppercase tracking-widest">Save</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="lg:col-span-7 space-y-6">
                <div class="grid grid-cols-2 gap-4">
                    <div class="glass-card rounded-3xl p-6">
                        <p class="text-[10px] font-bold text-[var(--blue-6)] opacity-60 uppercase mb-1">Expenses</p>
                        <p id="totalExpense" class="text-2xl font-black mono text-white">$0.00</p>
                    </div>
                    <div class="glass-card rounded-3xl p-6 bg-white/[0.15]">
                        <p class="text-[10px] font-bold text-[var(--blue-6)] uppercase mb-1">Net Balance</p>
                        <p id="netIncome" class="text-2xl font-black mono text-white">$0.00</p>
                    </div>
                </div>

                <div class="glass-card rounded-[2.5rem] p-8">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="font-bold text-lg">Spending Analysis</h3>
                        <select id="monthSelector" onchange="updateStats()" class="bg-black/20 border-none rounded-xl px-4 py-2 text-xs font-bold text-[var(--blue-5)] outline-none"></select>
                    </div>
                    <div class="h-[250px] flex items-center justify-center">
                        <canvas id="categoryChart"></canvas>
                    </div>
                </div>

                <div class="glass-card rounded-[2.5rem] p-8">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="font-bold text-lg">Timeline</h3>
                        <button onclick="clearAll()" class="text-[10px] font-bold text-white/30 hover:text-red-400 transition-colors uppercase tracking-widest">Clear All</button>
                    </div>
                    <div id="history" class="space-y-4 max-h-[400px] overflow-y-auto pr-4 custom-scroll"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // æ ¸å¿ƒé€»è¾‘ä¿æŒä¸€è‡´ï¼Œé’ˆå¯¹æ–° UI è¿›è¡Œäº†å¾®è°ƒ
        const CATEGORIES = {
            expense: [
                { name: 'Fixed', icon: 'ğŸ ' }, { name: 'Variable', icon: 'ğŸ›’' },
                { name: 'Fun', icon: 'â˜•' }, { name: 'Transport', icon: 'ğŸš—' },
                { name: 'Health', icon: 'ğŸ’Š' }, { name: 'Other', icon: 'ğŸ“¦' }
            ],
            income: [
                { name: 'Salary', icon: 'ğŸ’¼' }, { name: 'Bonus', icon: 'ğŸ' },
                { name: 'Invest', icon: 'ğŸ“ˆ' }, { name: 'Gifts', icon: 'ğŸ‰' }
            ]
        };

        let currentType = 'expense';
        let selectedCategory = '';
        let chartInstance = null;

        function init() {
            document.getElementById('date').valueAsDate = new Date();
            generateMonthSelector();
            renderCategories();
            updateStats();
            renderHistory();
        }

        function generateMonthSelector() {
            const selector = document.getElementById('monthSelector');
            const now = new Date();
            for (let i = 0; i < 12; i++) {
                const d = new Date(now.getFullYear(), i, 1);
                const value = `${now.getFullYear()}-${String(i + 1).padStart(2, '0')}`;
                const isSelected = i === now.getMonth() ? 'selected' : '';
                selector.innerHTML += `<option value="${value}" ${isSelected}>${d.toLocaleString('default', { month: 'short' })} ${now.getFullYear()}</option>`;
            }
        }

        function switchType(type) {
            currentType = type;
            selectedCategory = '';
            document.getElementById('expenseTab').classList.toggle('tab-active', type === 'expense');
            document.getElementById('incomeTab').classList.toggle('tab-active', type === 'income');
            document.getElementById('expenseTab').classList.toggle('text-white/50', type !== 'expense');
            document.getElementById('incomeTab').classList.toggle('text-white/50', type !== 'income');
            renderCategories();
        }

        function renderCategories() {
            const container = document.getElementById('categoryContainer');
            container.innerHTML = CATEGORIES[currentType].map(cat => `
                <button onclick="selectCategory('${cat.name}')" data-category="${cat.name}"
                    class="category-btn flex flex-col items-center justify-center p-3 rounded-2xl">
                    <span class="text-xl mb-1">${cat.icon}</span>
                    <span class="text-[9px] font-bold uppercase tracking-tighter">${cat.name}</span>
                </button>
            `).join('');
        }

        function selectCategory(name) {
            selectedCategory = name;
            document.querySelectorAll('.category-btn').forEach(btn => {
                btn.classList.toggle('category-selected', btn.dataset.category === name);
            });
        }

        function saveRecord() {
            const amount = parseFloat(document.getElementById('amount').value);
            const date = document.getElementById('date').value;
            const note = document.getElementById('note').value.trim();

            if (!amount || !selectedCategory) return alert('Enter amount and select category');

            const record = { id: Date.now(), type: currentType, amount, category: selectedCategory, note: note || 'Transaction', date };
            const records = JSON.parse(localStorage.getItem('finance_tracker_aud') || '[]');
            records.unshift(record);
            localStorage.setItem('finance_tracker_aud', JSON.stringify(records));

            document.getElementById('amount').value = '';
            document.getElementById('note').value = '';
            selectedCategory = '';
            renderCategories();
            updateStats();
            renderHistory();
        }

        function updateStats() {
            const selectedMonth = document.getElementById('monthSelector').value;
            const records = JSON.parse(localStorage.getItem('finance_tracker_aud') || '[]');
            const monthRecords = records.filter(r => r.date.startsWith(selectedMonth));
            
            const expense = monthRecords.filter(r => r.type === 'expense').reduce((sum, r) => sum + r.amount, 0);
            const income = monthRecords.filter(r => r.type === 'income').reduce((sum, r) => sum + r.amount, 0);

            document.getElementById('totalExpense').textContent = '$' + expense.toLocaleString(undefined, {minimumFractionDigits: 2});
            document.getElementById('netIncome').textContent = '$' + (income - expense).toLocaleString(undefined, {minimumFractionDigits: 2});
            
            updateChart(monthRecords.filter(r => r.type === 'expense'));
        }

        function updateChart(records) {
            const dataMap = {};
            records.forEach(r => dataMap[r.category] = (dataMap[r.category] || 0) + r.amount);
            
            const ctx = document.getElementById('categoryChart').getContext('2d');
            if (chartInstance) chartInstance.destroy();
            
            chartInstance = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: Object.keys(dataMap),
                    datasets: [{
                        data: Object.values(dataMap),
                        backgroundColor: ['#BBDFFA', '#97BAEC', '#6987D5', '#445BC1', '#2C43B8', '#1727AE'],
                        borderWidth: 0,
                        hoverOffset: 20
                    }]
                },
                options: {
                    cutout: '80%',
                    plugins: { 
                        legend: { position: 'right', labels: { color: '#BBDFFA', font: { size: 10, weight: '600' }, usePointStyle: true } }
                    }
                }
            });
        }

        function renderHistory() {
            const records = JSON.parse(localStorage.getItem('finance_tracker_aud') || '[]');
            const container = document.getElementById('history');
            
            container.innerHTML = records.slice(0, 15).map(r => `
                <div class="flex items-center justify-between p-4 bg-white/5 rounded-3xl border border-white/5 transition-all hover:bg-white/10">
                    <div class="flex items-center gap-4">
                        <div class="w-12 h-12 glass-card rounded-2xl flex items-center justify-center text-xl">${CATEGORIES[r.type].find(c => c.name === r.category)?.icon || 'ğŸ’°'}</div>
                        <div>
                            <p class="font-bold text-sm text-white">${r.category}</p>
                            <p class="text-[10px] text-[var(--blue-6)] opacity-50 font-bold uppercase">${r.date} â€¢ ${r.note}</p>
                        </div>
                    </div>
                    <div class="text-right">
                        <p class="font-black mono text-base ${r.type === 'expense' ? 'text-white' : 'text-[var(--blue-5)]'}">
                            ${r.type === 'expense' ? '-' : '+'}$${r.amount.toFixed(2)}
                        </p>
                        <button onclick="deleteRecord(${r.id})" class="text-[9px] font-bold text-white/20 hover:text-red-400 uppercase tracking-tighter">Remove</button>
                    </div>
                </div>
            `).join('');
        }

        function deleteRecord(id) {
            let records = JSON.parse(localStorage.getItem('finance_tracker_aud') || '[]');
            records = records.filter(r => r.id !== id);
            localStorage.setItem('finance_tracker_aud', JSON.stringify(records));
            updateStats();
            renderHistory();
        }

        function clearAll() {
            if (confirm('Clear all data?')) {
                localStorage.removeItem('finance_tracker_aud');
                updateStats();
                renderHistory();
            }
        }

        function exportData() {
            const records = JSON.parse(localStorage.getItem('finance_tracker_aud') || '[]');
            let csv = 'Type,Category,Amount,Date,Note\n';
            records.forEach(r => csv += `${r.type},${r.category},${r.amount},${r.date},"${r.note}"\n`);
            const blob = new Blob([csv], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `blue_finance_export.csv`;
            a.click();
        }

        init();
    </script>
</body>
</html>
